---
title: "Лабораторная работа 4"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = 'd:/Code/University/Mag_1sem/R/Labs/Third_lab/')
```

## 1. USJudgeRatings

Рейтинги адвокатов судей штата в Верховном суде США.

### Признаки

Датасет, содержащий 43 наблюдения по 12 числовым переменным:

-   [,1] CONT Количество контактов адвоката с судьей.

-   [,2] INTG Честность судей.

-   [,3] DMNR Поведение.

-   [,4] DILG Усердие.

-   [,5] CFMG Управление потоком обращений.

-   [,6] DECI Оперативность решений.

-   [,7] PREP Подготовка к судебному разбирательству.

-   [,8] FAMI Знакомство с законом.

-   [,9] ORAL Обоснованность устных решений.

-   [,10] WRIT Обоснованность письменных решений.

-   [,11] PHYS Физические способности.

-   [,12] RTEN Оценка вероятности продолжения работы.

```{r}
attach(USJudgeRatings)
```

## 2. Корреляционная матрица

Подключим необходимые библиотеки.

```{r echo = T, results = 'hide'}
library(corrplot)
library(car)
```

```{r}
corrplot(cor(USJudgeRatings), method="number", type="upper")
```

## 3. Парная линейная регрессия

### Высокая корреляция

Рассмотрим линейную регрессию 2 признаков с высокой корреляцией - отношение между физическими способностями и честностью.

```{r}
fit <- lm(INTG~PHYS)
plot(PHYS, INTG)
lines(PHYS, predict(fit), col="red")
```

```{r}
summary(fit)
```

Как видим, несмотря на наличие нескольких выбросов коэффициенты регрессии и сама регрессия оказываются статистически значимыми.

### Низкая корреляция

Рассмотрим 2 признака с низкой корреляцией, а именно количество контактов адвоката с судьей и Честность судей.

```{r}
fit <- lm(INTG~CONT)
plot(CONT, INTG)
lines(CONT, predict(fit), col="red")
```

```{r}
summary(fit)
```

Как видим, p-value для R^2^ \> 0.1, поэтому получаемая линейная регрессия не является статистически значимой.

## 4. Множественная линейная регрессия

Для множественной регрессии рассмотрим, как оценка вероятности продолжения работы судей зависит от количества контактов адвоката с судьей и оценкой подготовленности к судебному разбирательству. Ниже представленна матрица их корреляций.

```{r}
ratings <- as.data.frame(USJudgeRatings[,c("CONT", "PREP", "RTEN")])
```

```{r}
corrplot(cor(ratings), method="number", type="upper")
```

Представим изображения парных линейных регрессий для указанных признаков.

```{r}
scatterplotMatrix(ratings)
```

Как видим, между CONT и другими признаками нет зависимости.

Рассмторим теперь множественную модель.

```{r}
fit <- lm(RTEN ~ CONT+PREP)
summary(fit)
```

Как видим, коэффициенты при свободном члене и CONT не являются статистически значимыми, значит их можно считать нулевыми. Коэффициент же при PREP является статистически значимым, как и сама модель.
