---
title: "Лабораторная работа 3"
output: word_document
date: "2022-11-22"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = 'd:/Code/University/Mag_1sem/R/Labs/Third_lab/')
```

## 1. USJudgeRatings

Рейтинги адвокатов судей штата в Верховном суде США.

### Признаки

Датасет, содержащий 43 наблюдения по 12 числовым переменным:

-   [,1] CONT Количество контактов адвоката с судьей.
-   [,2] INTG Честность судей.
-   [,3] DMNR Поведение.
-   [,4] DILG Усердие.
-   [,5] CFMG Управление потоком обращений.
-   [,6] DECI Оперативность решений.
-   [,7] PREP Подготовка к судебному разбирательству.
-   [,8] FAMI Знакомство с законом.
-   [,9] ORAL Обоснованность устных решений.
-   [,10] WRIT Обоснованность письменных решений.
-   [,11] PHYS Физические способности.
-   [,12] RTEN Оценка вероятности продолжения работы.

```{r}
attach(USJudgeRatings)
```

## 2. Параный корреляционный анализ для переменных DECI и PREP
Подключим необходимые библиотеки.
```{r echo = T, results = 'hide'}
library(ggplot2)
library(corrplot)
library(Hmisc)
```

### Распределение переменных

Взглянем на распределения переменных DECI и PREP.
```{r}
hist(DECI)
```

```{r}
hist(PREP)
```

### График рассеяния

Получим график рассеяния для этих переменных.
```{r}
ggplot(USJudgeRatings)+aes(x=DECI, y=PREP)+geom_point(colour="red")
```

### Коэффициенты корреляции

Из графика рассеяния можно предположить, что существует положительная корреляция между переменными.
```{r}
cor.test(DECI, PREP, method="pearson")
```

Коеффициент корреляции Пирсона \> 0.9, значит имеем высокую положительную корреляцию. При этом p-value \< 0.05, поэтому крэффициент является статистически значимым.

Проверим другие два коэффициента.

```{r}
cor.test(DECI, PREP, method="kendall")
```

```{r}
cor.test(DECI, PREP, method="spearman")
```

p-value в них также меньше 0.05, поэтому коэффициент корреляции также будет отличен от 0.

## 3. Корреляционная матрица

### Графики рассеяния для нескольких переменных

Перед построением корреляционной матрицы построим графики рассеяния для нескольких переменных.
```{r}
pairs(USJudgeRatings[,c("CONT", "DMNR", "ORAL", "WRIT", "PHYS", "RTEN")])
```

Как видим боьшинство переменных предположительно имеют положительную корреляцию. И лишь для у переменной CONT нет зависимости от других признаков.

### Корреляционная матрица
Теперь построим корреляционную матрицу.
```{r}
corrplot(cor(USJudgeRatings), method="number", type="upper")
```

Подтвредилось, утверждение о том, что все переменные кроме CONT имеют высокую положительную корреляцию.

### Матрица p-value

Дополнительно взглянем на матрицу p-value.
```{r}
round(rcorr(as.matrix(USJudgeRatings))$P, 3)
```

Как видим, для всех переменных кроме CONT p-value \< 0.05, значит между ними существует статистически занчимая корреляционная связь.
